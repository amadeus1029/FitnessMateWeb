<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="exercise">
    <select id="showList" resultType="ExVo">
        <![CDATA[
            select  partNo as exPartNo,
                    partName as exPartName
            from    ex_part
            order by partNo asc
        ]]>
    </select>
    <select id="getList" parameterType="int" resultType="ExVo">
        <![CDATA[
            select  ex.exerciseNo as exNo,
                    ex.exerciseName as exName,
                    p.partName as exPartName,
                    ex.unit as unit
            from    exercise ex, ex_part p
            where   ex.trainerNo = #{trainerNo}
            and     ex.exercisepart = p.partNo
            order by ex.exerciseNo asc
        ]]>
    </select>
    <select id="partList" parameterType="int" resultType="ExVo">
        <![CDATA[
            select  exp.exPartNo as exPartNo,
                    p.partName as exPartName
            from    ex_part p, (select  exPartNo,
                                        count(*)
                                from    (select e.exercisepart as exPartNo
                                        from    exercise e, ex_part p
                                        where   e.exercisepart = p.partno and e.trainerno = #{trainerNo})
                                group by exPartNo
                                order by exPartNo) exp
            where   p.partNo = exp.expartno
        ]]>
    </select>
    <select id="selectByPart" parameterType="ExVo" resultType="ExVo">
        <![CDATA[
            select  e.exerciseno as exNo,
                    e.exercisename as exName,
                    e.unit as unit
            from    exercise e, ex_part p
            where   e.exercisepart = p.partNo and e.trainerNo = #{trainerNo} and e.exercisepart = #{exPartNo}
            order by e.exerciseno asc
        ]]>
    </select>
    <select id="selectByNo" parameterType="int" resultType="ExVo">
        <![CDATA[
            select  ex.exerciseNo as exNo,
                    ex.exerciseName as exName,
                    p.partName as exPartName,
                    ex.unit as unit
            from    exercise ex, ex_part p
            where   ex.exerciseNo = #{exNo}
            and     ex.exercisepart = p.partNo
        ]]>
    </select>
    <insert id="insertSelectKey" parameterType="ExVo">
        <selectKey keyProperty="exNo" resultType="int" order="BEFORE">
            <![CDATA[
                select seq_exerciseno.nextVal from dual
            ]]>
        </selectKey>
        <![CDATA[
            insert into exercise
            values(#{exNo}, #{trainerNo}, #{exName}, #{exPartNo}, #{unit})
        ]]>
    </insert>
    <delete id="delete" parameterType="ExVo">
        <![CDATA[
            delete exercise
            where exerciseNo = #{exNo} and trainerNo = #{trainerNo}
        ]]>
    </delete>
</mapper>

        <!--
        <![CDATA[
        ]]>
        -->